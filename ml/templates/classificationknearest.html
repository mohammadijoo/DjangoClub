{% extends "portfolio/base-en2.html" %}

{% block cssStyle %}  
.lighttag {
  color: #e8f9fd !important;
}
{% endblock %}
{% block content %}
<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Prediction Results</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <h5>Prediction Input:</h5>
                <div style="color:black;">Temperature(K): <span id="te" style="color:black;"></span></div>
                <div style="color:black;">Relative Luminosity: <span id="rl" style="color:black;"></span></div>
                <div style="color:black;">Relative Radius: <span id="rr" style="color:black;"></span></div>
                <div style="color:black;">Absolute Magnitude: <span id="am" style="color:black;"></span></div>
                <div style="color:black;">General Obs. Color: <span id="co" style="color:black;"></span></div>
                <div style="color:black;">SMASS Spec: <span id="ma" style="color:black;"></span></div>
                <h5 class="pt-3">Prediction Classification   </h5>
                <div id="prediction" style="color:black;"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <a class="btn btn-primary" href="{% url 'ml:classificationresultknn' %}" role="button">View Previous Results</a>
            </div>
        </div>
    </div>
</div>

<!--<h1 ></h1>-->

<div class="container pt-3">
    <div class="row justify-content-md-center">
        <div class="col-md-12 ustify-content-md-center text-center">
            
            <span style="font-size:1.5rem; font-weight:600; " class="m-2 ">
                <a href="{% url 'ml:classificationresultknn' %}" target="_blank" style="border-bottom: 1px solid #ffb766;" class="lighttag"> 
                    Results</a>
            </span> 
            
            <span style="font-size:1.5rem; font-weight:600; " class="m-2">
                <a href="https://github.com/mohammadijoo/Datasets/blob/main/stars.py" target="_blank" style="border-bottom: 1px solid #ffb766;" class="lighttag"> 
                    Source Code</a>
            </span>
            
            <span style="font-size:1.5rem; font-weight:600; " class="m-2">
                <a href="https://github.com/mohammadijoo/Datasets/blob/main/stars.csv" target="_blank" style="border-bottom: 1px solid #ffb766;" class="lighttag"> 
                    Dataset</a>
            </span> <br>
            
        </div>
        
        <div class="col-md-2"></div>
        <div class="col-md-8">
            
            <h1 style="font-family: 'Caveat Brush', cursive; color:#A28089; font-size:3rem" class="text-center mt-4 mb-1">
                Stars Classification
            </h1>
            <h1 style="font-family: 'Caveat Brush', cursive; color:#A28089; font-size:2rem" class="text-center mb-4">
                Using <u>K-Nearest Neighbor</u> Classification Model
            </h1>
            <h6 style="color: #00ABE4; font-size:0.8rem;" class="text-center mb-2">
                After submitting the form, wait at least <u>10 seconds</u>  for the model to calculate and show the result. <br> Also, all entered float numbers must have at most 2 decimal points, like: 1.23
            </h6>
            
            <form action="" id="post-form">
                {% csrf_token %}
                <div class="form-group">
                    <label for="Temperature">Temperature <small class="pl-4" style="color:#BFA181;">(Between 1939 and 40000)</small> </label> 
                    <input type="number" step="0.01" class="form-control" id="Temperature" placeholder="" required>
                </div>
                <div class="form-group">
                    <label for="L">Relative Luminosity <small class="pl-4" style="color:#BFA181;">(Between 0.00008 and 849420)</small> </label>
                    <input type="number" step="0.01" class="form-control" id="L" placeholder="" required>
                </div>
                <div class="form-group">
                    <label for="R">Relative Radius <small class="pl-4" style="color:#BFA181;">(Between 0.0084 and 1948.5)</small> </label> 
                    <input type="number" step="0.01" class="form-control" id="R" placeholder="" required>
                </div>
                <div class="form-group">
                    <label for="A_M">Absolute Magnitude <small class="pl-4" style="color:#BFA181;">(Between -11.92 and 20.06)</small> </label>
                    <input type="number" step="0.01" class="form-control" id="A_M" placeholder="" required> 
                </div>
                <div class="form-group">
                    <label for="Color">General Obs. Color <small class="pl-4" style="color:#BFA181;">See the Color Codes in Description Below</small> </label>
                    <select name="Color" id="Color" form="post-form" class="form-control" required>
                      <option value="0">0</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                      <option value="6">6</option>
                      <option value="7">7</option>
                      <option value="8">8</option>
                      <option value="9">9</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="Spectral_Class">SMASS Spec. <small class="pl-4" style="color:#BFA181;">See the Spectral Classes in Description Below</small></label>
                    <select name="Spectral_Class" id="Spectral_Class" form="post-form" class="form-control" required>
                      <option value="0">0</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                      <option value="6">6</option>
                    </select>
                </div>
                <button type="submit" value="Submit" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">Submit</button>
            </form>
        </div>
        <div class="col-md-2"></div>
        
        
        <div class="col-md-12 mt-5">
            
            <h1 style="font-family: 'Caveat Brush', cursive; color:#99775C; font-size:2.5rem" class="text-justify mt-4 mb-1">
                Model Description:
            </h1>
            
            <p style="font-size:1.3rem" class="text-justify">
                
                Classification is a supervised machine learning method where the model tries to predict the correct label of a given input data. One of the algorithms used for classification is <a href="https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm" target="_blank">“K-Nearest Neighbor Classifier”</a>. <br>
                Here, we use the <b style="color:#6E6E6E"><u>stars.csv</u></b> dataset for classification purposes and you can download the dataset from the link on top of this page.  <br>
                This dataset has 6 features: <br>
                “<i style="color:#6ACFC7">Temperature</i>”, “<i style="color:#6ACFC7">Relative Luminosity</i>”, “<i style="color:#6ACFC7">Relative Radius</i>”, “<i style="color:#6ACFC7">Absolute Magnitude</i>”, “<i style="color:#6ACFC7">General Obs. Color</i>” and “<i style="color:#6ACFC7">SMASS Spec.</i>” <br>
                And the label for each item in the dataset is the type of Star, which has 6 values: <br>
                “<i style="color:#6ACFC7">Red Dwarf</i>”, “<i style="color:#6ACFC7">Brown Dwarf</i>”, “<i style="color:#6ACFC7">White Dwarf</i>”, “<i style="color:#6ACFC7">Main Sequence</i>”, “<i style="color:#6ACFC7">Super Giants</i>” and “<i style="color:#6ACFC7">Hyper Giants</i>”. <br>
                In the above form, you enter the values of 6 features and the model returns the type of star in a pop-up form. As 2 features of our dataset are Categorical and 4 of them are Numerical, for using K-Nearest Neighbor for this mixed dataset, we need to convert categorical features to numerical labels and then we could use the K-Nearest Neighbor Classifier.  <br>
                Formula for "Relative Luminosity":  L/Lo  (Lo = 3.828 x 10<sup>26</sup> Watts  &#8594  Avg Luminosity of Sun)    <br>
                Formula for "Relative Radius":  R/Ro (Ro = 6.9551 x 10<sup>8</sup> m  &#8594  Avg Radius of Sun)    <br>
                Notice that the values and ranges of each feature is as below:  <br>
                
                <span class="badge m-2 p-2" style="background-color: #213F99"> 1939 < Temperature (K) < 40000   </span>   <br>                               
                <span class="badge m-2 p-2" style="background-color: #213F99"> 0.00008 < Relative Luminosity < 849420 </span> <br>
                <span class="badge m-2 p-2" style="background-color: #213F99"> 0.0084 < Relative Radius < 1948.5   </span> <br>
                <span class="badge m-2 p-2" style="background-color: #213F99"> -11.92 < Absolute Magnitude < 20.06  </span>  <br>
                <span class="badge m-2 p-2 text-left" style="background-color: #213F99; line-height:1.5rem"> Color Codes: <br>  0 → Blue , 1 → Blue White , 2 → Orange <br> 3 → Orange-Red , 4 → Pale yellow orange , 5 → Red <br> 6 → White , 7 → Whitish , 8 → Yellow White <br> 9 → Yellowish  </span>   <br>                              
                <span class="badge m-2 p-2 text-left" style="background-color: #213F99; line-height:1.5rem"> Spectral Classes: <br> 0 → A , 1 → B ,  2 → F ,  3 → G ,  4 → K , 5 → M ,  6 → O   </span> <br>
                                      
                For more information about Spectral Classes, see this <a href="https://en.wikipedia.org/wiki/Asteroid_spectral_types" target="_blank"> link </a>. <br>
                                          
                The sample code used to train a “K-Nearest Neighbor” classification model, is provided in the link on top of this page. Each time you run this form and classification predictions happen, the values will store in the database, and with the link “result” on top of this page, you will see the previous results of the model prediction. Your recent run will be added to the end of this list.  

            </p>
            
        </div>
        
        
        
        
        
    </div>
</div>

<script>
    $(document).on('submit', '#post-form',function(e){
        e.preventDefault();
        $.ajax({
            type:'POST',
            url:'{% url "ml:submit_classification_knn" %}',
            data:{
                Temperature:$('#Temperature').val(),
                L:$('#L').val(),
                R:$('#R').val(),
                A_M:$('#A_M').val(),
                Color:$('#Color').val(),
                Spectral_Class:$('#Spectral_Class').val(),
                csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val(),
                action: 'post'
            },
            success:function(json) {
                document.forms["post-form"].reset();
                document.getElementById("prediction").innerHTML = json['result']
                document.getElementById("te").innerHTML = json['Temperature']
                document.getElementById("rl").innerHTML = json['L']
                document.getElementById("rr").innerHTML = json['R']
                document.getElementById("am").innerHTML = json['A_M']
                document.getElementById("co").innerHTML = json['Color']
                document.getElementById("ma").innerHTML = json['Spectral_Class']
            },
            error : function(xhr,errmsg,err) {
                alert(err);
            },
        });
    })
</script>

{% endblock %}

